apiVersion: apps/v1
kind: Deployment
metadata:
  name: pubsub-gcs-processor
  namespace: processor
  labels:
    app: pubsub-gcs-processor
spec:
  replicas: 1
  selector:
    matchLabels:
      app: pubsub-gcs-processor
  template:
    metadata:
      labels:
        app: pubsub-gcs-processor
    spec:
      serviceAccountName: pubsub-gcs-processor
      containers:
      - name: pubsub-gcs-processor
        imagePullPolicy: Always
        image: gcr.io/jkwng-images/pubsub-gcs-processor:latest # Replace with your image
        env:
        - name: PROJECT_ID
          value: "jkwng-kueue-dev"
        - name: SUBSCRIPTION_NAME
          value: "data-bucket-changes-sub"
        - name: MAX_MESSAGES
          value: "10"
        - name: PROMPT_TEMPLATE_CONFIGMAP_NAME
          value: processor/prompt-template
        - name: VLLM_API_URL
          value: "http://gemma3-vllm.processor.svc.cluster.local/v1"
        - name: MODEL_ID
          value: "google/gemma-3-4b-it"
